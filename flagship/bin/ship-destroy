#!/usr/bin/env bash
set -euo pipefail

NAME="$1"
[[ -n "$NAME" ]] || { echo "ERROR: ship name required" >&2; exit 1; }

ssh exe.dev rm "ship-${NAME}" || true

jq --arg name "$NAME" 'del(.ships[$name])' \
   ~/.ohcommodore/fleet.json > ~/.ohcommodore/fleet.json.tmp \
   && mv ~/.ohcommodore/fleet.json.tmp ~/.ohcommodore/fleet.json

echo "Ship '$NAME' destroyed."
